_jacobian_type = numerical, analytical           | expand
_name_sufix = {_jacobian_type}
__name = test_jacobian_{_name_sufix}

[grid]
file = grids/test_cell.msh
initial_level = 0

[model]
begin_time = 0.
end_time = 0.01
time_step = 2e-3
order = 1

# extra 
jacobian_type = {_jacobian_type}

[model.compartments]
cell     = 0
nucleoid = 1

############################ Model for cell ############################
[model.cell.operator]
u = 0

[model.cell.initial]
u = 10

[model.cell.reaction]
u = -5*u

[model.cell.reaction.jacobian]
du_du = -5

[model.cell.diffusion]
u = 1.

[model.cell.writer]
file_name = {__name}_cell

############################ Model for nucleoid ############################
[model.nucleoid.operator]
u = 0
v = 0

[model.nucleoid.initial]
u = 5
v = 10

[model.nucleoid.reaction]
u = -u*v
v = -10*u

[model.nucleoid.reaction.jacobian]
du_du = -v
du_dv = -u
dv_du = -10
dv_dv = 0

[model.nucleoid.diffusion]
u = 1.
v = 1.

[model.nucleoid.writer]
file_name = {__name}_nucleoid

######################### Compare with reference vtk ######################### 
[wrapper.vtkcompare]
name = {__name}_cell/{__name}_cell-00005 {__name}_nucleoid/{__name}_nucleoid-00005
reference = reference/cell-00005 reference/nucleoid-00005
extension = vtu vtu
relative = 2e-2
absolute = 1e-9

############################ Logging settings #################################
# levels = off, critical, error, waring, notice, info, debug, trace, all

[logging]
default.level = trace

[logging.sinks.stdout]
pattern = "[\\{reldays:0>2\\}-\\{reltime:8%T\\}] [\\{backend\\}] \\{msg\\}"

[logging.backend.model]
level = trace
indent = 2

[logging.backend.solver]
level = trace
indent = 4